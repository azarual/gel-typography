/*------------------------------------*\
    #TOOLS
\*------------------------------------*/

/**
 * Output the specified type group and optional create a bold or non touch
 * variant if requested
 */
@mixin gel-output-type-group($group-name, $bold-variant: false, $no-touch-styles: false) {

    // check that we've got the right type of data
    @if (type-of($gel-type-settings) != map) {

        @warn "$gel-type-settings is expected to be a Sass map, looks like something's not right here";

    } @else {

        // loop through each font class
        @each $type-class, $type-values in $gel-type-settings {

            // check if styles are defined for the current group
            @if map_has_key($type-values, $group-name) {

                // output the styles for the current type class
                .#{$gel-type-namespace}#{$type-class},
                %#{$gel-type-namespace}#{$type-class} {

                    @include gel-output-type-settings(map_get($type-values, $group-name));

                    // if we need touch detection then return the styles for the relivant group
                    @if $no-touch-styles {

                        .#{$gel-type-touch-class} & {
                            @include gel-output-type-settings(map_get($type-values, $gel-type-no-touch-group));
                        }

                    }

                }

                // output a bold variant for each font
                @if $bold-variant {

                    .#{$gel-type-namespace}#{$type-class}-bold,
                    %#{$gel-type-namespace}#{$type-class}-bold {
                        @extend %#{$gel-type-namespace}#{$type-class};

                        &,
                        .#{$gel-type-touch-class} & {
                            font-weight: bold;
                            @include gel-output-letter-spacing-adjustment(map_get($type-values, $group-name));
                        }

                    }

                }

            }

        }

    }

}

/**
 * Loop through a supplied Sass map and return each key & value
 * as CSS properities and values
 */
@mixin gel-output-type-settings($type-values) {

    @each $property, $value in $type-values {

        // if we've got a pixel value then convert it to a `rem`
        @if ($gel-type-enable-rem-output and type-of($value) == number) {

            // check we've got a px value that we'll need for the `rem` convertion
            @if (unitless($value)) {

                @warn "Assuming #{$value} to be in pixels, attempting to convert it into pixels for you";
                $value: $value + 0px;

            }

            // pass the property and value into the rem function
            @include rem($property, $value);

        } @else {

            #{$property}: $value;

        }

    }

}

/**
 * The GEL typographic style relies on tight tracking for large headers
 * By default a negative adjustment to letter spacing is applied to all
 * type sizes above 18px, proportional to â€“3%. In CSS this equates to -1px
 *
 * This mixin is used to automatically apply this adjustment if the font-size
 * meets the above critera
 */
@mixin gel-output-letter-spacing-adjustment($type-values) {

    // only return this if the letter spacing adjustment is enabled
    @if $gel-type-letter-spacing-adjustment {

        // check if we've got a font-size value and its greater than 18px
        @if (map-has-key($type-values, font-size) and map-get($type-values, font-size) > 18px) {

            @include rem('letter-spacing', -1px);

        }

    }

}
